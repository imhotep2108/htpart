\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{htplogos}

\newif\ifhtplogos@setlogo

\DeclareOption{setlogo}{\htplogos@setlogotrue}
\ExecuteOptions{setlogo}
\ProcessOptions\relax

\RequirePackage{xcolor}
\RequirePackage{attachfile2}

\definecolor{navy}{HTML}{003153}
\definecolor{teal}{HTML}{008c8c}

\DeclareRobustCommand{\HTPart}{\textsf{\textit{\textcolor{navy}{HTP}}}\texttt{\textsc{\textcolor{teal}{art}}}}

\NewDocumentCommand{\setlogo}{sO{\LARGE\@ifclassloaded{htpart}{\HTPart}{}}}{
    \AddToHook{shipout/foreground}{
        \tikz[remember picture,overlay]{
            \node at (current page.north \if@twoside\ifodd\thepage east\else west\fi\else east\fi) [shift={(\if@twoside\ifodd\thepage-0.06\paperheight\else0.06\paperheight\fi\else-0.06\paperheight\fi,-0.03\paperheight)}] {\IfBooleanTF{#1}{#2}{\textattachfile{\jobname.tex}{#2}}}
        }
    }
}

\ifhtplogos@setlogo
\setlogo
\fi

\endinput
